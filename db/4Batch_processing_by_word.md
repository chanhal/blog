Word批量化写论文
================

> Windows上，Word无疑是最强大的文档编辑排版工具，但是真正熟悉它，能够运用其中的技巧来方便我们完成毕业论文、项目文档，实现批量化的操作流程，这样的People似乎不太多。这里将本人在完成毕业论文和平时整理项目文档过程中的经验整理于此。


# 批量化步骤

处理过程大致分为以下七个步骤，按照“先搭建框架然后到细节”、“先填充内容然后修改格式”、“先正文部分然后增加前后辅助内容”的思路进行文档的编排，期间会穿插一个Word的实用技巧。

## 第一步：搭建框架

在开始文档编写时，往往首先需要拟出一个大纲，它将囊括文档的全部内容，大纲内容在开始阶段可能不是很准确，也许后续需要进一步调整，但是应该反映文档的基本结构。有了大纲，就可以开始文档编写的第一步了，将大纲对应到Word中就是文档的多级标题，增加多级标题的时候就应该为各个不同级别的标题定义好相对应的格式，这样在文档编写过程中增加一个标题时只需要将相应的标题格式应用至该标题文字就可以排出清晰的标题，同时在Word左边列出清晰的大纲，方便我们实时查看，做到心中有数。

![图 1. 多级目录效果图]()

多级标题的定义通常是需要参照已有的格式要求（当然你也可以按照自己心目中的想法来办），它可以是一份别人已经完整写好的文档（也就是通常被叫做“模版”的东西），从中获取需要的格式参数；它也可以是一个格式说明，如图2，它是一份毕业论文的格式要求，完整列出了各种格式参数，后面也是参照这个要求来进行的。

![图 2. 格式说明]()

在知道了标题格式的基础上，我们通过“定义新的多级目录”来制作不同样式的各级标题，如图3.

![图 3. 定义新的多级目录]()

定义的多级目录通常最多至4级，一般毕业论文和项目文档也是这样要求的，再者目录结构太深也不方面自己和他人查看。有人可能要问，“我的文档目录比较深，可能到5级以上，这时该怎么办？”这是一般的解决措施是增加一些小的编号来编排，如下：

* （一）、（二）、（三）
* （1）、（2）、（3）
* 1）、2）、3）
* 第一步、第二步、第三步
* “项目符号”，如箭头、方形、圆形符号

相信有了以上辅助编号，小伙伴们再也不会觉得不够用了吧。但是需要注意这些符号使用的级别顺序，别弄的不伦不类的啦。

以上是个小插曲，继续我们的定义多级目录。从第一级目录开始，如图4定义第一级目录，参数设置过程按照图4中蓝色数字顺序，注意第三步选择中文编号“一二三四”，然后第四步出现“一”，然后人为在“一”前后增加“第”和“章”组成“第一章”，然后将“对齐位置”和“文本缩进位置”设置为0，具体效果可以参照上方的预览图。最后一步选择“空格”，因为图2格式要求缩进一个空格。

![图 4. 定义一级目录]()

这样第一级标题的格式就定义好了，而且与Word顶部的样式中的“标题1”进行了关联，接下来进一步修改“标题1”的样式，在“标题1”上右键选择“修改”，如图5.

![图 5. 点击“修改”标题1]()
![图 6. 修改一级目录样式]()

然后按照图6中蓝色数字的顺序进行设置，1、2和3分别设置“字体、字号、加粗和居中”，第4步选择“格式”中的“段落”，在“段落”对话框中分别设置段前和断后行距为1.2和1倍间距，最后设置“单倍”行距后确定。

经过这些步骤第一级目录设置成功，继续第二级目录的设置。如图6，定义第二级目录时，第3步应该选择数字，然后在第4步选择“正规形式编号”。

![图 7. 定义二级目录]()

按照图7设置第二级目录的样式。接下来对于第三级第四级目录的设置过程就不再列举出来，请看官参照第一级和第二级的步骤，并遵照图2中的格式参数自行尝试设置。

![图 8. 定义二级目录样式]()


## 第二步：插入各章节内容

在这一步正式插入各个章节的内容，可以包括文字、图片、表格、公式、参考文献、Viso对象（一般是可编辑的流程图），插入过程中不用考虑格式的问题（文字字体、行距、缩进），只要将位置摆放正确即可。在这一部分内容中我着重想叙述的是插入图表和公式，因为这两个内容的编号对于Word的自动化排版有重要作用。

### 图片插入和引用

正式文档中，插入图表时必须增加相应的题注，题注位置遵照“表头图尾”的位置规则，即，表格的题注插在表格的上方，而图片则插在图片下方。如何插入图片和题注，以及居中对齐都没什么好讲的，相信看官都清楚，而这里需要叙述的是给题注编号，以及对编过号的题注的引用。

按照图9红色数字顺序依次选择对象选项，第一步选择面板中的“插入题注”，第二步在“题注”对话框中，选择“新建标签”，然后，也就是第三步在“新建标签”对话框中写入“图”，这样在选项中的标签中就出现了叫做“图”的标签，以后插图的就是该标签，第四步为该标签选择编号，并选择“包含章节号”，并选择“标题1”，这里稍微解释一下这么做的意思就是：针对每一个第一级目录进行图片重新编号，例如：“图 1-2”表示的就是第一章中的第二张图片。插入题注后出现的是“图 一-1”，看起来比较怪，这是因为第一级目录中的编号选择的是中文编号，不要担心，马上就重点来解决这个问题。

![图 9. 给图片插入题注]()

处理的办法就是采用修改题注的“域代码”，在开始修改之前，我先介绍几个处理域的快捷键：

* ctrl+shift+f9组合键：把域转为纯文本
* Ctrl+F9组合键：      快速插入域定义符“{}”(注意:这个花括号不能用键盘输入)
* Shift+F9组合键：     显示或者隐藏指定的域代码
* Alt+F9组合键:        显示或者隐藏文档中所有域代码
* F9键：               更新单个域
* CTRL+A（全选）F9键 ：批量更新域

按照图10的步骤开始处理，选中“图 一-1”，使用快捷键“shift+F9”转换成域代码，然后在选中“{ STYLEREFT 1 \s }”，使用快捷键“ctrl+F9”快速插入域定义符，然后按照图插入红色方框中的内容，然后选中整个域代码，“shift+F9”转换回正常显示，然后选中转换回的编号（默认转换回后是选中状态）使用快捷键“F9”刷新这个域。

![图 10. 修改图片题注]()

千万不要嫌弃这一步太麻烦，因为一旦你做好了图片的题注编号，以后只需要将该编号复制过去，然后选中后“F9”刷新一下就会自动更改过去，真正做到了以逸待劳。

给图片增加题注后，剩下的就是在正文中引用图片题注，这一步很简单，看看图11就应该能够明白。

![图 11. 引用图片题注]()

### 表格插入和引用

表格题注插入其实与图片题注基本类似，无非是在图9中“新建标签”时填入“表”，其它过程类似。然后在引用题注时，图11中第二步选择“引用类型”中选择“表”。过程类似，就不具体展开，将精力集中在其它不一样的内容上吧！

### 公式插入和引用

个人感觉在插入公式题注的摸索阶段要比图标困难，后来从好友那里学得其中的技巧后，感觉也很容易、方便。



3. 正文与目录、封面用“分节符”隔开，不同章节之间用“分页符”

4. 整体修改正文字体、行距、缩进
修改参考文献的样式、字体、缩进

5. 插入“页眉”，自动为每页添加章节标题，在“插入”->“文档部件”->“域”中，分两次插入章节编号和章节名
注：正文第一页的页眉处应该设置“取消链接前一条页眉”，此时前面也自动插入页眉，手动删掉即可
插入“页脚”与页眉相似，正文编号可能不是从1开始编号，此时右键，在格式中修改一下即可

6. 插入目录，修改字体、行距

7. 修改图、表、公式与编号的字体


# 附

下面记录如何利用EndNote来管理自己文档中的参考文献。

## 安装EndNote
首先你需要一个Windows版本的安装包，可以在网上找破解版，也可以直接发送邮件找我要（邮箱地址在["关于"](http://chanhal.github.io/about/)页面中）。此处略去如何安装。

安装完毕后Word中会增加一个EndNote菜单项，如下图。
![图 10](http://7xpx1m.com1.z0.glb.clouddn.com/gh/004/10.jpg)

点击图中"Go to EndNote"可以直接打开EndNote，因此Word和EndNote通过这种方式进行了关联。EndNote打开后如下图。
![图 11](http://7xpx1m.com1.z0.glb.clouddn.com/gh/004/11.jpg)

接下来的任务是从文献数据库网站下载EndNote版本的文献参考格式文件，这个文件中记录了你的参考文献的格式所有信息，然后利用这个文件将文献格式导入EndNote。下面将分别针对中文和英文两种文献格式的导入进行讲解。

## 插入中文文献

中文文献为我们所熟悉，最常用的当然要属“中国知网”，所以中文文献导入EndNote将以知网为例来讲解。

![图 12](http://7xpx1m.com1.z0.glb.clouddn.com/gh/004/12.jpg)
首先浏览器中输入"cnki.net"打开知网，输入搜索关键词，知网为我们列出了搜索结果，以搜索“高光谱”为例，将前3条记录导出文献格式文件，点击"导出/参考文献"。

![图 13](http://7xpx1m.com1.z0.glb.clouddn.com/gh/004/13.jpg)
选中待导出文献，再次点击"导出/参考文献"。

![图 14](http://7xpx1m.com1.z0.glb.clouddn.com/gh/004/14.jpg)
选择左边“EndNote”，然后点击上面的“导出”，此时导出以“CNKI-”为开头的文本文件。

![图 15](http://7xpx1m.com1.z0.glb.clouddn.com/gh/004/15.jpg)
然后打开EndNote，点击Import->File。

![图 16](http://7xpx1m.com1.z0.glb.clouddn.com/gh/004/16.jpg)
在“Import File”对话框中，选择刚才下载的文本格式文件，然后“Import Option”中选择"EndNote Import"，然后点击“Import”，就可以将下载的文献格式导入EndNote，如上图三篇文献，右边是它的具体格式内容。

回到Word中，将光标定位在需要才入参考问文献的位置处，点击图11中的"Go to EndNote"打开EndNote，然后在EndNote中选中参考文献，点击插入。如图17。
![图 17](http://7xpx1m.com1.z0.glb.clouddn.com/gh/004/17.jpg)

导入后的效果如图18，在文段末插入参考文献，有作者和日期信息（当然格式可以在图中“Style”中修改），同时在文档末还会插入完整的文献信息。
![图 18](http://7xpx1m.com1.z0.glb.clouddn.com/gh/004/18.jpg)


## 插入英文文献